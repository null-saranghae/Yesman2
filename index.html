<!doctype html>
<html lang="ko">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ì˜ˆìŠ¤ë§¨ì„ ì°¾ì•„ë¼</title>
<head>
    <style>
  
    </style>
</head>
<body>
    <h1>ì˜ˆìŠ¤ë§¨ì„ ì°¾ì•„ë¼!</h1>
    <h2>ì•„ë¬´ë‚˜ í´ë¦­í•´ë³´ì„¸ìš”! ì˜ˆìŠ¤ë§¨ì„ ì°¾ì„ ë•Œ ê¹Œì§€!</h2>
    <button id="reshuffle">ë‹¤ì‹œ ì„ê¸°</button>
  <div id="stage" style="position:relative; height:80vh; border:1px solid #ccc; overflow:hidden; margin-top:8px;"> 
    
  </div>

  <script>
  // === ì„¤ì • ===
  const COUNT = 12;                          // ì‚¬ëŒ ìˆ˜
  const YES_FILE = 'yes.mp3';                // YES ì˜¤ë””ì˜¤(1ê°œ)
  const NO_FILES = ['no1.mp3','no2.mp3','no3.mp3','no4.mp3'];    // NO ì˜¤ë””ì˜¤ë“¤
  const SIZE = 96;                           // í”½í† ê·¸ë¨ í¬ê¸°(px) â˜…í¬ê²Œ

  const stage = document.getElementById('stage');
  const btn   = document.getElementById('reshuffle');
  let people = [];       // {el,x,y,dx,dy,w,h,audio,isYes}
  let animId = null;
  let playing = null;

  function stopPlaying(){
    if (playing){ playing.pause(); playing.currentTime = 0; playing = null; }
  }
  const pick = arr => arr[Math.floor(Math.random()*arr.length)];
  const rand = (min,max) => Math.random()*(max-min)+min;

  function makePerson(isYes){
    const el = document.createElement('span');
    el.textContent = 'ğŸ§';
    el.style.position = 'absolute';
    el.style.cursor = 'pointer';
    el.style.fontSize = SIZE + 'px';   // â˜…í¬ê¸° ì ìš©
    stage.appendChild(el);

    const audio = new Audio(isYes ? YES_FILE : pick(NO_FILES));
    audio.preload = 'auto';

    el.onclick = () => {
      stopPlaying();
      audio.currentTime = 0;
      audio.play().catch(()=>{});
      playing = audio;
      if (isYes) alert('YES! ì°¾ì•˜ë‹¤!');
    };

    // ì´ˆê¸° ìœ„ì¹˜/ì†ë„ (ê±°ì˜ ì•ˆ ì›€ì§ì´ë„ë¡ ë§¤ìš° ëŠë¦¬ê²Œ)
    const r = stage.getBoundingClientRect();
    const p = {
      el,
      x: rand(10, r.width - 10),
      y: rand(10, r.height - 10),
      // â˜… ì•„ì£¼ ëŠë¦° ì†ë„(í”½ì…€/í”„ë ˆì„). í•„ìš”ì‹œ ë” ë‚®ì¶”ì„¸ìš”.
      dx: rand(0.01, 0.1) * (Math.random()<.5?-1:1),
      dy: rand(0.01, 0.1) * (Math.random()<.5?-1:1),
      audio,
      isYes,
      w: el.offsetWidth,
      h: el.offsetHeight
    };
    return p;
  }

  function layout(p){
    p.el.style.left = p.x + 'px';
    p.el.style.top  = p.y + 'px';
  }

  function animate(){
    const r = stage.getBoundingClientRect();
    people.forEach(p=>{
      p.x += p.dx; p.y += p.dy;
      // ê²½ê³„ ë°˜ì‚¬ (ìš”ì†Œ ì‹¤ì œ í¬ê¸° ì‚¬ìš©)
      if (p.x < 0 || p.x > r.width - p.w)  p.dx *= -1;
      if (p.y < 0 || p.y > r.height - p.h) p.dy *= -1;
      layout(p);
    });
    animId = requestAnimationFrame(animate);
  }

  function spawn(){
    cancelAnimationFrame(animId);
    stopPlaying();
    stage.innerHTML = '';
    people = [];

    const yesIndex = Math.floor(Math.random()*COUNT);
    for(let i=0;i<COUNT;i++){
      const p = makePerson(i===yesIndex);
      // í™”ë©´ ë°– ì‹œì‘ ë°©ì§€ (ìš”ì†Œ í¬ê¸° ë°˜ì˜)
      p.x = Math.min(Math.max(p.x, 0), stage.clientWidth  - p.w);
      p.y = Math.min(Math.max(p.y, 0), stage.clientHeight - p.h);
      people.push(p);
      layout(p);
    }
    animId = requestAnimationFrame(animate);
  }

  document.getElementById('reshuffle').onclick = spawn;
  window.addEventListener('resize', spawn);
  spawn();
  </script>
</body>
</html>
